/**
 * report
 * @authors tammy (http://tammylights.com)
 * @date    2015-11-20 11:12:19
 * @version 1.0
 */
var allData = {
	shopList: [{
		"shopName": "北京开元汽车运输服务有限公司",
		"shopAddress": " 北京市北京市房山区北京市房山区琉璃河镇琉璃河商业街2-68号",
		"shopPhone": " 010-80300475 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京润泓达物流有限公司",
		"shopAddress": "北京市北京市密云县密云镇大唐庄村铁路西侧北洼子1号",
		"shopPhone": "13501077191 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京金利永通建筑工程有限公司",
		"shopAddress": "北京市北京市延庆县大榆树镇下屯村东区171号208室",
		"shopPhone": "15652588889 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京益铸泰达金属材料有限公司",
		"shopAddress": "北京市北京市顺义区李遂镇太平辛庄村委会西50米",
		"shopPhone": "15010217417 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京宝兑通节能科技服务有限公司",
		"shopAddress": "北京市北京市东城区金鱼池中街4号楼",
		"shopPhone": "18322779316 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京山河中天科贸有限公司",
		"shopAddress": "北京市北京市通州区通州区宋庄镇",
		"shopPhone": "18610836446 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京顺港兴业汽车销售有限公司",
		"shopAddress": "北京市北京市顺义区南法信镇政府西侧500米",
		"shopPhone": "018810031530 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京尚鸿豪嘉商贸有限公司",
		"shopAddress": "北京市北京市顺义区南法信镇顺畅大道1号R-07室",
		"shopPhone": "13701156535 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京鑫鸿瑞丰商贸有限公司",
		"shopAddress": "北京市北京市顺义区南法信镇顺畅大道1号R-B08室",
		"shopPhone": "13701334235 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京圣吉昌顺商贸有限公司",
		"shopAddress": "北京市北京市通州区北京市通州区西集镇国防路43号A座932",
		"shopPhone": "13366337036 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京中伟翔天汽车销售服务有限公司",
		"shopAddress": "北京市北京市朝阳区崔各庄乡奶子房村345号",
		"shopPhone": "18901399950 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京域峰商贸有限公司",
		"shopAddress": "北京市北京市朝阳区西大望路甲12号",
		"shopPhone": "17710040157 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京兆丰兴业土方工程有限公司",
		"shopAddress": "北京市北京市大兴区魏善庄",
		"shopPhone": "13311312207 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京一和得时商贸有限公司",
		"shopAddress": "北京市北京市朝阳区八里庄西里61号楼1809",
		"shopPhone": "13911708540 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "华阳中基远洋控股有限公司",
		"shopAddress": "北京市北京市朝阳区建国门外大街九号七号楼三单元一层011号",
		"shopPhone": "15801320632 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京展威信达贸易有限公司",
		"shopAddress": "北京市北京市房山区房山区燕山路17号",
		"shopPhone": "13146962411 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京中运物流有限公司顺义分公司",
		"shopAddress": "北京市北京市顺义区南法信镇顺畅大道1号R-A-024室",
		"shopPhone": "13818236640 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京鑫运通达运输有限公司",
		"shopAddress": "北京市北京市昌平区昌平镇南环路28号楼一层",
		"shopPhone": "1351144335 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京强诺运通运输有限公司",
		"shopAddress": "北京市北京市丰台区万源西里17栋一层",
		"shopPhone": "13146592370 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京瀚林美博物流有限公司",
		"shopAddress": "北京市北京市通州区经济开发区东区科海大道584号",
		"shopPhone": "13911898232 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京华盛永顺运输有限公司",
		"shopAddress": "北京市北京市通州区宋庄",
		"shopPhone": "15227826219 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京信达昌顺商贸有限公司",
		"shopAddress": "北京市北京市房山区燕山",
		"shopPhone": "13522791823 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京鑫跃恒通物流有限公司",
		"shopAddress": "北京市北京市顺义区南法信镇顺畅大道1号R-B011室",
		"shopPhone": "13811495686 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京鑫旺路通商贸有限公司",
		"shopAddress": "北京市北京市顺义区南法信镇顺畅大道1号R-A-06室",
		"shopPhone": "13381119809 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京恒泰盛诚汽车销售有限公司",
		"shopAddress": "北京市北京市顺义区南法信镇顺畅大道1号R-308室",
		"shopPhone": "13121043956 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京瑞鑫通达储运有限公司",
		"shopAddress": "北京市北京市怀柔区怀沙路",
		"shopPhone": "13601375674 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京兴芳伟业进出口贸易有限公司",
		"shopAddress": "北京市北京市丰台区花乡汾庄村488号",
		"shopPhone": "13810337816 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京蓝普翔航空货运代理有限公司",
		"shopAddress": "北京市北京市顺义区北京市顺义区天竺镇杨二营村26号",
		"shopPhone": "13141055351 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京坤宏顺达物流有限公司",
		"shopAddress": "北京市北京市平谷区北京市平谷区马坊物流基地东区726号",
		"shopPhone": "15311580907 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京瑞升源商贸有限公司",
		"shopAddress": "北京市北京市顺义区南法信镇顺畅大道1号R-A-05室",
		"shopPhone": "15811374573 13701334235 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}, {
		"shopName": "北京金利永顺建筑工程有限公司",
		"shopAddress": "北京市北京市延庆县大榆树镇下屯村东区171号204室",
		"shopPhone": "18614026990 ",
		"shopHomeLink": "http://www.baidu.com",
		"shopMainImg": "/src/images/shop_s.jpg"
	}]
};

function TammyMap() {
	var me = this;
	this.init = function() {
		var bmap = document.getElementById('selfMap');
		if (bmap === null) {
			var script = document.createElement('script');
			script.type = 'text/javascript';
			script.id = 'selfMap';
			script.src = "http://api.map.baidu.com/api?v=2.0&ak=8nSiXscCROaAl1M2zwZgkycm&callback=selfMap.initMap";
			document.body.appendChild(script);
		} else {
			selfMap.initMap();
		}
	};
	this.initMap = function() {
		this.initShopList();
		var map = this.createMap();
		this.createMapPoint(map);
		this.registerEvent(map);
	};
	this.initShopList = function() {
		var shopHtml = ky.utils.template('shopList_item', allData);
		$('#popup-map-shopList').empty().html(shopHtml);
	};
	this.createMap = function() {
		var map = new BMap.Map('allmap', {
			minZoom: 5,
			enableMapClick: false
		});
		map.centerAndZoom('北京', 11);
		map.disableDoubleClickZoom(true);
		return map;
	};
	this.createMapPoint = function(map) {
		var myGeo = new BMap.Geocoder();
		for (var i = 0, len = allData.shopList.length; i < len; ++i) {
			var item = allData.shopList[i];
			(function(item,i) {
				myGeo.getPoint(item.shopAddress, function(point) {
					if (point) {
						var myIcon = new BMap.Icon('/src/images/addrOther.png', new BMap.Size(18, 24));
						var mark = new BMap.Marker(point, {
							icon: myIcon
						});
						mark.setTitle('shop-map-identity-' + i);
						map.addOverlay(mark);
						mark.addEventListener('click', function() {
							map.centerAndZoom(point, 17);
							var iw = ky.utils.template('BMapInfoTip_template', item);
							var infoWindow = new BMap.InfoWindow(iw);
							this.openInfoWindow(infoWindow);
							document.getElementById('imgDemo').onload = function() {
								infoWindow.redraw();
							};
						});
					}
				});
			})(item,i);
		}
	};
	this.registerEvent = function(map){
		$('body').on('click','#popup-map-shopList li',function(){
			var m = $(this);
			var title = m.data('title');
			$(".BMap_Marker.BMap_noprint[title='"+title+"']").trigger('click');
		});
	};
}
var selfMap = new TammyMap();
selfMap.init();

function asd(e) {
	var m = $(e);
	//m.parent().hide();
	$('.leftAddr-box').hide();
	$('#allmap').css({
		"width": "1040px"
	});
}